Mon Nov 26 13:37:24 CET 2001  Jan Hubicka  <jh@suse.cz>

	* ifcvt.c (process_double_test_block): Fix negative counts.

Mon Nov 26 12:53:11 CET 2001  Jan Hubicka  <jh@suse.cz>

	* c-common.h (GOTO_FAKE_P): New macro.
	* tree-inline.c (GOTO_FAKE_P): Set.
	* c-tree.texi (GOTO_FAKE_P): Document.
	* Makefile.in (c-semantics.o): Add predict.h dependency.
	(stmt.o): Fix predict.h depdendency.

	* c-semantics.c: Include predict.h;
	(expand_stmt): Drop prediction on goto.
	* predict.c (preocess_note_predictions): Fix formating.
	* predict.def (PRED_CONTINUE, PRED_NEGATIVE_RETURN): New predictors.
	* stmt.c (maybe_error_return): Kill.
	(return_prediction): New.
	(expand_goto): Do not generate predictions.
	(expand_continue_loop): Do generate prediction.
	(expand_null_return): Do not generate predictions.
	(expand_value_return): Use return_prediction.

Mon Nov 26 11:53:36 CET 2001  Jan Hubicka  <jh@suse.cz>

	* sibcall.c (optimize_sibling_and_tail_recursive_call): Kill
	NOTE_INSN_RETURN and NOTE_INSN_PREDICTION leaked to the code.

Mon Nov 26 11:48:57 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfganal.c (flow_dfs_compute_reverse_add_bb): set visited bit.
	(flow_dfs_compute_reverse_execute): Add only unvisited blocks.

2001-11-25  Andreas Jaeger  <aj@suse.de>

	* toplev.c (rest_of_compilation): Call
	find_exception_handler_labels.
	Patch by Jan Hubicka <jh@suse.cz>.

Thu Nov 15 11:29:10 CET 2001  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>
	
	* Makefile.in (stmt.o): Add predict.h dependency.
	* basic-block.h (CLEANUP_UNREACHABLE_ONLY): New constant.
	(note_prediction_to_br_prob): Declare.
	* cfgcleanup.c (cleanup_cfg): Allow to only delete unreachable blocks.
	* predict.c (process_note_prediction, process_note_predictions,
	is_last_basic_block): New static functions.
	(estimate_probability): Moved noreturn blocks handling to
	process_note_predictions.
	(note_prediction_to_br_prob): New function.
	* predict.def (PRED_GOTO, PRED_CONST_RETURN, PRED_NIL_RETURN):
	New predictions.
	* predict.h (IS_TAKEN, IGNORE_IN_LAST): New constants.
	* print-rtl.c (print_rtx): Printing of NOTE_INSN_PREDICTION.
	* rtl.h (NOTE_INSN_PREDICTION, NOTE_INSN_RETURN): New.
	(NOTE_PREDICTION, NOTE_PREDICTION_ALG, NOTE_PREDICTION_FLAGS,
	NOTE_PREDICT): New.
	* rtl.c (note_insn_name): Names for them.
	* stmt.c: Include predict.h.
	(maybe_error_return): New static function.
	(expand_goto): Emit prediction note.
	(expand_null_return, expand_value_return): Emit prediction and return
	notes.
	* toplev.c (rest_of_compilation): Call note_prediction_to_br_prob.
	* cfgrtl.c (can_delete_note_p, flow_delete_block): Removing our notes
	when their block disappear.

Fri Nov 23 14:42:40 CET 2001  Jan Hubicka  <jh@suse.cz>

	* invoke.texi: (-fweb, -dZ): Document.
	(-O3): Document that -fweb is enabled.
	* passes.texi (web construction pass): Document.

Thu Nov 22 16:51:20 CET 2001  Jan Hubicka  <jh@suse.cz>

	Mainline merger (cfg-merger-20011122 tag).

Wed Nov 21 19:41:48 CET 2001  Jan Hubicka  <jh@suse.cz>

	* tracer.c: Revert to original algorithm.

Wed Nov 21 10:47:35 CET 2001  Jan Hubicka  <jh@suse.cz>

	* tracer.c: Include flags.
	(ignore_bb_p): New function.
	(MIN_COUNT, MIN_FREQUENCY, DYNAMIC_COVERAGE, MAXIMAL_CODE_GROWTH):
	new constatns.
	(better_p): Avoid roundoff errors.
	(find_best_successor, find_best_predecessor): Ignore ignored
	blocks.
	(is_trace_head_p): Do not care ENTRY_BLOCK_PTR.
	(tail_duplicate): Ignore ignored blocks; limit code growth

Tue Nov 20 18:52:33 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfg.c (dump_flow_info):  Verify the profile.

	* profile.c (compute_branch_probabilites):  Compute probabilities 
	for entry/exit edges; estimate probabilities for zero counts.

	* cfglayout.c (cfg_layout_duplicate_bb):  Fix profile updating
	code.

Tue Nov 20 16:58:37 CET 2001  Jan Hubicka  <jh@suse.cz>

	* web.c: Include function.h
	(union_defs): Copy pseudo's flags; union noop moves.

Mon Nov 19 14:13:35 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cfg_layout_duplicate_bb): Avoid overflow.

Mon Nov 19 13:22:58 CET 2001  Jan Hubicka  <jh@suse.cz>

	* gcse.c (delete_null_pointer_checks_1): Do not use delelete_list;
	call purge_dead_edges after removing.
	(delete_null_pointer_checks): Do not handle delete_list.

Mon Nov 19 12:05:45 CET 2001  Jan Hubicka  <jh@suse.cz>

	* gcse.c (delete_null_pointer_checks): Call delete_related_insns.

Sun Nov 18 11:55:20 CET 2001  Jan Hubicka  <jh@suse.cz>

	* predict.c (block_info_def, edge_info_def): Add volatiles.

Sat Nov 17 21:10:33 CET 2001  Jan Hubicka  <jh@suse.cz>

	* i386.c (ix86_cc_mode): Accept USE.

	* cse.c (cse_insn): really do not record equivalences of the
	last instruction.

Sat Nov 17 19:12:52 CET 2001  Jan Hubicka  <jh@suse.cz>

	* web.c (union_defs): Union uses of the instruction that
	do use same pseudo.

Sat Nov 17 16:30:45 CET 2001  Jan Hubicka  <jh@suse.cz>

	* toplev.c (rest_of_compilation): Fix ordering problem of PDO.
	* tracer.c: New heuristics.

Sat Nov 17 14:32:07 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfgrtl.c (purge_dead_edges):  Cleanup EDGE_ABNORMAL flag if computed
	jump is turned into simplejump.

Fri Nov 16 21:13:46 CET 2001  Jan Hubicka  <jh@suse.cz>

	* gcse.c (try_replace_reg): Copy RTX before creating note.

Thu Nov 15 18:18:50 CET 2001  Jan Hubicka  <jh@suse.cz>

	* Makefile.in (web.o): Add.
	* rtl.h (web_main): Add prototype.
	* timervar.def (TV_WEB): New.
	* toplev.c (dump_file_index): Add DFI_web.
	(dump_file_info): Add "web".
	(flag_web): New static variable.
	(f_options): Add "web".
	(rest_of_compilation): Call web_main.
	(toplev_main): Add flag_web.
	* web.c: New file.

	* df.h (df_ref_flags): New uenum.
	(DF_REF_FLAGS): New macro.
	(struct ref): Add field "flags".
	* df.c (HANDLE_SUBREG): Remove.
	(df_ref_create): Likewise; set flags field of ref.
	(df_def_record_1): Strip down read_write subreg; remove
	commented out code; set READ_WRITE flag.
	(read_modify_subreg_p): New static function.
	(df_uses_record): Cleanup SET handling; set READ_WRITE flag;
	new argument "flags".
	(df_insn_refs_record): Update call of df_uses_record.
	(df_insn_modify): Avoid #if 0 around comment.
	(df_dump): Dump the read/write flag.

Thu Nov 15 16:53:20 CET 2001  Jan Hubicka  <jh@suse.cz>

	* predict.c (propagate_freq): Make cyclic_probability and frequency
	volatile

Wed Nov 14 18:25:13 CET 2001  Jan Hubicka  <jh@suse.cz>

	* tracer.c (tracer): Re-add lost mark_dfs_back_edges call.

Wed Nov 14 14:48:07 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cfg_layout_duplicate_bb): Fix libcalls.

Wed Nov 14 14:07:20 CET 2001  Jan Hubicka  <jh@suse.cz>

	* tracer.c (count_insns): New function.
	(construct_traces): Tweek heuristics.

Wed Nov 14 14:04:14 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cfg_layout_duplicate_bb): Grok libcall sequences.

Tue Nov 13 16:26:24 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfgclenaup.c (try_forward_edges, try_crossjump_to_edge):
	Never produce negative counts/frequencies.
	* cfglayout.c (cfg_layout_duplicate_bb): Likewise.
	* cfgrtl.c (verify_flow_info): Check frequncies.

Tue Nov 13 15:54:33 CET 2001  Jan Hubicka  <jh@suse.cz>

	* toplev.c (DFI_tracer): New.
	(dump_file_info): Add DFI_tracer.
	(rest_of_compilation): reorganize tracer handling; add some
	sanity checks.
	* timervar.def (TV_TRACER): New.

2001-11-13  Andreas Jaeger  <aj@suse.de>

	* cfgcleanup.c (thread_jump): Rename label fail to avoid warning.

Tue Nov 13 14:05:19 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cleanup_unconditional_jumps): Do not get confused
	by dead jumptables.

Tue Nov 13 13:30:32 CET 2001  Jan Hubicka  <jh@suse.cz>

	* c-decl.c (c_expand_body): Fix TV_EXPAND nesting problem;
	measure integration time separately.

	* gcse.c (delete_null_pointer_checks_1): Fix CFG udpate.

	* toplev.c (rest_of_compilation): Avoid most of cfg rebuilds.

Tue Nov 13 12:28:49 CET 2001  Jan Hubicka  <jh@suse.cz>

	* predict.c (expected_value_to_br_prob): Delete the note
	once transformed.

Mon Nov 12 19:58:01 CET 2001  Andreas Jaeger <aj@suse.de>

	* tracer.c: Fix spelling and whitespace.

Mon Nov 12 19:23:18 CET 2001  Josef Zlomek  <zlomek@matfyz.cz>

	* cfgloop.c (flow_loops_find): Use the information of the depth
	first search order of the CFG correctly when finding natural loops.

Mon Nov 12 18:56:36 CET 2001  Jan Hubicka  <jh@suse.cz>

	* Makefile.in (cfgcleanup.o): Add cselib.h dependancy.
	* basic-block.h (CLEANUP_THREADING): New constant.
	* cfgcleanup.c: Include cselib.h
	(thread_jump, mark_effect): New functions.
	(try_forward_edges): Do jump threading when asked for.
	* jump.c (mark_modified_reg, save_regs, num_same_regs, modified_regs,
	modified_mem, thread_jumps, rtx_equal_for-thread_p): Kill.
	* rtl.h (thread_jumps, rtx_equal_for_thread_p): Kill.
	* toplev.c (rest_of_compilation): Do now call thread_jumps; use
	CLEANUP_THREAD instead.

Mon Nov 12 18:36:09 CET 2001  Jan Hubicka  <jh@suse.cz>

	* Makefile.in (tracer.o): Add.
	* rtl.h (tracer): New function.
	* toplev.c (flag_tracer): New.
	(f_options): add -ftracer.
	(rest_of_compilation): Call tracer.
	(toplev_main): Enable tracer at -O2.
	* tracer.c: New file.

Mon Nov 12 17:02:31 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cfg_layout_can_duplicate_bb_p,
	cfg_layout_duplicate_bb): New functions.
	* cfglayout.h (cfg_layout_can_duplicate_bb_p,
	cfg_alyout_duplicate_bb): Declare.

Mon Nov 12 16:35:21 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (fixup_fallthru_exit_predecesor): New static function.
	(cfg_layout_finalize): Use it.
	* bb-reorder.c (HAVE_epilogue): Remove.
	(make_reorder_chain): Do not care special placement of 
	last basic block.

Mon Nov 12 16:25:53 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (cleanup_unconditional_jumps): New static function.
	(cfg_layout_initialize): Use it.

Mon Nov 12 14:19:07 CET 2001  Jan Hubicka  <jh@suse.cz>

	* cfglayout.c (struct scope_def): Kill fields note_beg, note_end,
	bb_beg, bb_end, bbs, num_bbs; add block.
	(scope_forest_info): Kill.
	(forest): Rename to scope_tree.	
	(relate_bbs_with_scope, insert_intra_1, insert_intra_bb_scope_notes,
	insert_inter_bb_scope_notes): Kill.
	(rebuild_scope_notes): Take scope parameter; rewrite.
	(dump_scope_forest): Rename to dump_scope_tree.
	(dump_scope_forest_1): Rename to dump_scope_tree_1.
	(free_scope_forest): Rename to free_scope_tree; rewrite.
	(free_scope_forest_1): Kill.
	(get_next_bb_note, get_prev_bb_note): Kill.
	(set_insn_scopes, regenerate_block_notes): New.
	(INSN_SCOPE): New.
	(insn_scope): New varray.
