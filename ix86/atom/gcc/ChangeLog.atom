2009-04-20  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Update comments.

2009-04-19  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Use register
	numbers as parameters.  Update comments.
	(distance_agu_use): Use register number parameter.
	(ix86_lea_for_add_ok): Updated.

2009-04-19  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Use
	INVALID_REGNUM for invalid register number.

2009-04-14  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Assume that op1
	is register and op1 is non-subreg.
	(ix86_lea_for_add_ok): Assert operands[1] is register and
	operands[2] isn't subreg.

2009-04-14  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Support
	SUBREG.  Use DF instead of reg_set_p.
	(reg_mentioned_by_mem_p): Removed.
	(distance_agu_use): Updated.  Use DF instead of reg_set_p.

2009-04-14  Joey Ye  <joey.ye@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Implement with DF.

2009-04-12  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (ix86_dep_by_shift_count_body): Updated.

2009-04-11  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (ix86_dep_by_shift_count): Renamed to ...
	(ix86_dep_by_shift_count_body): This.  Properly handle PARALLEL
	patterns.
	(ix86_dep_by_shift_count): New.

2009-04-11  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Call
	extract_insn_cached only once.

2009-04-10  Joey Ye  <joey.ye@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Fix typo in
	previous revision.

2009-04-09  Joey Ye  <joey.ye@intel.com>

	* config/i386/i386.c (distance_non_agu_define): Use attr_type to
	check lea.

2009-04-06  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/atom.md: Updated to GPL v3.

2009-03-30  H.J. Lu  <hongjiu.lu@intel.com>

	* rtl.h (reg_mentioned_by_mem_p): Removed.

	* rtlanal.c (reg_mentioned_by_mem_p): Moved ...
	* config/i386/i386.c (reg_mentioned_by_mem_p): Here.

2009-03-30  Joey Ye  <joey.ye@intel.com>

	* rtlanal.c (reg_mentioned_by_mem_p_1): Removed.
	(reg_mentioned_by_mem_p): Re-implement with DF.

2009-03-29  H.J. Lu  <hongjiu.lu@intel.com>

	* rtl.h (reg_dep_by_addr_p): Removed.
	* rtlanal.c (reg_dep_by_addr_p): Likewise.

2009-02-05  Joey Ye  <joey.ye@intel.com>
	    Xuepeng Guo <xuepeng.guo@intel.com>
	    H.J. Lu  <hongjiu.lu@intel.com>

	Atom pipeline model, tuning and insn selection.
	* rtlanal.c (reg_mentioned_by_mem_p_1): New function.
	(reg_mentioned_by_mem_p): New function.
	(reg_dep_by_addr_p): New function.

	* rtl.h (reg_mentioned_by_mem_p): Declare new function.
	(reg_dep_by_addr_p): Likewise.

	* config.gcc (atom): Add atom config options and target.

	* config/i386/i386.h (TARGET_ATOM): New target macro.
	(X86_TUNE_OPT_AGU): New tuning flag.
	(TARGET_OPT_AGU): New target option.
	(TARGET_CPU_DEFAULT_atom): New CPU default.
	(PROCESSOR_ATOM): New processor.

	* config/i386/i386-c.c (ix86_target_macros_internal): New case
	PROCESSOR_ATOM.
	(ix86_target_macros_internal): Likewise.

	* config/i386/i386-protos.h (ix86_lea_for_add_ok): Declare new
	function.
	(ix86_dep_by_shift_count): Likewise.
	(ix86_agi_dependent): Likewise.

	* config/i386/i386.c (atom_cost): New cost.
	(m_ATOM): New macro flag.
	(initial_ix86_tune_fe): Set m_ATOM.
	(x86_accumulate_outgoing_args): Likewise.
	(x86_arch_always_fancy_math_387): Likewise.
	(processor_target): Add Atom cost.
	(cpu_names): Add Atom cpu name.
	(override_options): Set Atom ISA.
	(LEA_SEARCH_THRESHOLD): New macro.
	(IX86_LEA_PRIORITY): Likewise.
	(distance_non_agu_define): New function.
	(distance_agu_use): Likewise.
	(ix86_lea_for_add_ok): Likewise.
	(ix86_dep_by_shift_count): Likewise.
	(ix86_agi_dependent): Make it global.
	(ix86_issue_rate): New case PROCESSOR_ATOM.
	(ix86_adjust_cost): Likewise.

	* config/i386/i386.md (cpu): Add new value "atom".
	(atom.md): Include atom.md.
	(use_carry, movu): New attr.
	(adddi3_carry_rex64): Set attr "use_carry".
	(addqi3_carry): Likewise.
	(addhi3_carry): Likewise.
	(addsi3_carry): Likewise.
	(*addsi3_carry_zext): Likewise.
	(subdi3_carry_rex64): Likewise.
	(subqi3_carry): Likewise.
	(subhi3_carry): Likewise.
	(subsi3_carry): Likewise.
	(x86_movdicc_0_m1_rex64): Likewise.
	(*x86_movdicc_0_m1_se): Likewise.
	(x86_movsicc_0_m1): Likewise.
	(*x86_movsicc_0_m1_se): Likewise.
	(*adddi_1_rex64): Emit add insn as much as possible.
	(*addsi_1): Likewise.
	(return_internal): Set atom_unit.
	(return_internal_long): Likewise.
	(return_pop_internal): Likewise.
	(*rcpsf2_sse): Set atom_sse_attr attr.
	(*qrt<mode>2_sse): Likewise.
	(*prefetch_sse): Likewise.

	* config/i386/sse.md (cpu): Set attr "atom_sse_attr".
	(*prefetch_sse_rex): Likewise.
	(sse_rcpv4sf2): Likewise.
	(sse_vmrcpv4sf2): Likewise.
	(sse_sqrtv4sf2): Likewise.
	(<sse>_vmsqrt<mode>2): Likewise.
	(sse_ldmxcsr): Likewise.
	(sse_stmxcsr): Likewise.
	(*sse_sfence): Likewise.
	(sse2_clflush): Likewise.
	(*sse2_mfence): Likewise.
	(*sse2_lfence): Likewise.
	(avx_movup<avxmodesuffixf2c><avxmodesuffix>): Set attr "movu".
	(<sse>_movup<ssemodesuffixf2c>): Likewise.
	(avx_movdqu<avxmodesuffix>): Likewise.
	(avx_lddqu<avxmodesuffix>): Likewise.
	(sse2_movntv2di): Change attr "type" to "ssemov".
	(sse2_movntsi): Likewise.
	(rsqrtv8sf2): Change attr "type" to "sseadd".
	(sse3_addsubv2df3): Set attr "atom_unit".
	(sse3_h<plusminus_insn>v4sf3): Likewise.
	(*sse2_pmaddwd): Likewise.
	(*vec_extractv2di_1_rex64): Likewise.
	(*vec_extractv2di_1_avx): Likewise.
	(sse2_psadbw): Likewise.
	(ssse3_phaddwv8hi3): Likewise.
	(ssse3_phaddwv4hi3): Likewise.
	(ssse3_phadddv4si3): Likewise.
	(ssse3_phadddv2si3): Likewise.
	(ssse3_phaddswv8hi3): Likewise.
	(ssse3_phaddswv4hi3): Likewise.
	(ssse3_phsubwv8hi3): Likewise.
	(ssse3_phsubwv4hi3): Likewise.
	(ssse3_phsubdv4si3): Likewise.
	(ssse3_phsubdv2si3): Likewise.
	(ssse3_phsubswv8hi3): Likewise.
	(ssse3_phsubswv4hi3): Likewise.
	(ssse3_pmaddubsw128): Likewise.
	(sse3_pmaddubsw: Likewise.
	(ssse3_palignrti): Likewise.
	(ssse3_palignrdi): Likewise.

	* config/i386/atom.md: New.

2009-02-05  H.J. Lu  <hongjiu.lu@intel.com>

	* config/i386/i386.c (ix86_agi_dependent): Remove the third
	argument.  Swap the first 2 arguments.
	(ix86_adjust_cost): Updated.

2009-01-30  Vladimir Makarov  <vmakarov@redhat.com>

	* genautomata.c: Add a new year to the copyright.  Add a new
	reference.
	(struct insn_reserv_decl): Add comments for member bypass_list.
	(find_bypass): Remove.
	(insert_bypass): New.
	(process_decls): Use insert_bypass.
	(output_internal_insn_latency_func): Output all bypasses with the
	same input insn in one switch case.

	* rtl.def (define_bypass): Describe bypass choice.
	* doc/md.texi (define_bypass): Ditto.
